#!/usr/bin/env python3
from flask import Flask, jsonify, request
from gsd_database import GsdDatabase

app = Flask(__name__)
gsd_database = GsdDatabase(app)

@app.route('/gsd-database/<cve>/baseScore')
def get_base_score(cve):
    base_score_value = gsd_database.get_base_score(cve)
    if base_score_value is None:
        return 'File not found', 404
    return jsonify(base_score_value)

@app.route('/gsd-database/<cve>')
def get_file(cve):
    data = gsd_database.get_file(cve)
    if data is None:
        return 'File not found', 404
    return jsonify(data)

if __name__ == '__main__':
    app.run(debug=False)
