from flask import jsonify, Blueprint, current_app
from flask_wtf.csrf import CSRFProtect

api_routes = Blueprint('api_routes', __name__)
csrf = CSRFProtect(current_app)

@api_routes.route('/gsd-database/<cve>/baseScore', methods=['GET'])
@csrf.exempt
def get_base_score(cve):
    gsd_database = current_app.gsd_database
    base_score_value = gsd_database.get_base_score(cve)
    if base_score_value is None:
        return 'File not found', 404
    return jsonify(base_score_value)

@api_routes.route('/gsd-database/<cve>', methods=['GET'])
@csrf.exempt
def get_file(cve):
    gsd_database = current_app.gsd_database
    data = gsd_database.get_file(cve)
    if data is None:
        return 'File not found', 404
    return jsonify(data)
